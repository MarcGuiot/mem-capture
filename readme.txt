Code to capture all allocation.
To use add -javaagent:memory-profiler-X.Y.jar has JVM args
Add mem.profiler jvm property that points to the same jar memory-profiler-X.Y.jar
Do not rename the jar file. It's name is referenced in the jar manifest.

Partially AI generated code.